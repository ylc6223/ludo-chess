# Node.js 进程管理工具使用指南

## 📋 概述

`list-node-ports.sh` 是一个Node.js 进程管理工具，可以：
- 📊 查看所有运行中的 Node.js 进程
- 🔍 显示每个进程监听的端口
- 🎯 交互式选择和终止特定进程
- 🔄 实时刷新进程状态

## 🚀 快速开始

### 1. 安装和权限设置

```bash
# 赋予执行权限
chmod +x list-node-ports.sh
```

### 2. 基本运行

```bash
# 运行脚本
./list-node-ports.sh
```

## 📖 详细使用说明

### 🔍 查看模式

脚本启动后会自动扫描并显示所有 Node.js 进程：

```
正在查找所有 Node.js 进程及其监听端口...
-------------------------------------------
[1] PID: 12345  |  端口: 3000  |  命令: node server.js
[2] PID: 12346  |  端口: 5173  |  命令: node vite dev
[3] PID: 12347  |  (未监听端口)   |  命令: node /usr/local/bin/npm
[4] PID: 12348  |  端口: 8080  |  命令: node app.js
-------------------------------------------
```

**信息说明：**
- `[数字]`：进程编号，用于交互操作
- `PID`：进程 ID
- `端口`：进程监听的端口号（如果有）
- `命令`：完整的启动命令

### 🎮 交互模式

#### 进入交互模式

当发现 Node.js 进程时，脚本会询问：

```
是否进入交互模式来管理这些进程？(y/N):
```

- 输入 `y` 或 `Y`：进入交互模式
- 输入 `N` 或直接回车：退出脚本

#### 交互命令

进入交互模式后，可以使用以下命令：

| 命令 | 功能 | 示例 |
|------|------|------|
| `1-N` | 选择对应编号的进程 | 输入 `2` 选择第2个进程 |
| `r` 或 `R` | 刷新进程列表 | 重新扫描所有进程 |
| `q` 或 `Q` | 退出交互模式 | 返回命令行 |

#### 终止进程流程

1. **选择进程**：输入进程编号
   ```
   请选择操作 [1-4/q/r]: 2
   ```

2. **确认信息**：显示选中进程的详细信息
   ```
   选择的进程：
   PID: 12346  |  端口: 5173  |  命令: node vite dev

   确认要杀掉这个进程吗？(y/N):
   ```

3. **确认操作**：
   - 输入 `y` 或 `Y`：确认终止进程
   - 输入其他或直接回车：取消操作

4. **自动刷新**：成功终止进程后自动刷新列表

## 💡 使用场景

### 🔧 开发调试
```bash
# 查看开发服务器占用的端口
./list-node-ports.sh
# 快速终止卡死的开发服务器
```

### 🚀 部署管理
```bash
# 检查生产环境的 Node 服务
./list-node-ports.sh
# 安全地重启特定服务
```

### 🔍 端口冲突排查
```bash
# 找出占用特定端口的进程
./list-node-ports.sh
# 清理不需要的进程
```

## ⚠️ 注意事项

### 🛡️ 安全提醒
- ✅ 终止进程前会显示完整信息并要求确认
- ✅ 只能终止 Node.js 进程，不会影响系统进程
- ⚠️ 终止进程可能导致数据丢失，请谨慎操作
- ⚠️ 某些系统进程可能需要 `sudo` 权限

### 🔄 最佳实践
1. **先查看再操作**：了解每个进程的作用
2. **确认端口信息**：避免误杀重要服务
3. **使用刷新功能**：确保信息是最新的
4. **保存重要数据**：终止前保存工作进度

## 🐛 故障排除

### 常见问题

**Q: 没有找到 Node.js 进程**
```
没有找到 Node.js 进程。
```
**A:** 确保有 Node.js 应用正在运行

**Q: 无法杀掉进程**
```
无法杀掉进程 12345。可能需要 sudo 权限或进程已经不存在。
```
**A:** 尝试使用 `sudo ./list-node-ports.sh` 或检查进程是否已退出

**Q: 权限不足**
```bash
# 解决方案
sudo chmod +x list-node-ports.sh
# 或者
sudo ./list-node-ports.sh
```

## 📊 输出示例

### 完整交互流程示例

```bash
$ ./list-node-ports.sh

正在查找所有 Node.js 进程及其监听端口...
-------------------------------------------
[1] PID: 12345  |  端口: 3000  |  命令: node server.js
[2] PID: 12346  |  端口: 5173  |  命令: node vite dev
[3] PID: 12347  |  (未监听端口)   |  命令: node /usr/local/bin/npm
-------------------------------------------

是否进入交互模式来管理这些进程？(y/N): y

交互模式：
输入进程编号来杀掉对应进程，输入 'q' 退出，输入 'r' 刷新列表

请选择操作 [1-3/q/r]: 2

选择的进程：
PID: 12346  |  端口: 5173  |  命令: node vite dev

确认要杀掉这个进程吗？(y/N): y
进程 12346 已被杀掉。

刷新进程列表...
正在查找所有 Node.js 进程及其监听端口...
-------------------------------------------
[1] PID: 12345  |  端口: 3000  |  命令: node server.js
[2] PID: 12347  |  (未监听端口)   |  命令: node /usr/local/bin/npm
-------------------------------------------
输入进程编号来杀掉对应进程，输入 'q' 退出，输入 'r' 刷新列表

请选择操作 [1-2/q/r]: q
退出交互模式。
```

## 🎯 总结

这个工具让你能够：
- 🔍 **一目了然**：查看所有 Node.js 进程和端口占用情况
- 🎯 **精确控制**：选择性终止特定进程
- 🛡️ **安全操作**：多重确认机制防止误操作
- 🔄 **实时更新**：动态刷新进程状态

非常适合开发者日常调试、端口管理和进程清理工作！
